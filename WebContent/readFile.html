<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>在线预览</title>
	
    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="this is my page">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    
    <style type="text/css" media="screen"> 
			html, body	{ height:100%; }
			body { margin:0; padding:0; overflow:auto; }   
			#flashContent { display:none; }
     </style> 
     <script type="text/javascript" src="webpage/js/jquery-1.7.1.js"></script>
	<script type="text/javascript" src="flexpaper/js/flexpaper_flash.js"></script>
  </head>
  
  <body>
    <div style="position:absolute;left:200px;top:10px;">
	        <a id="viewerPlaceHolder" style="width:1000px;height:800px;display:block"></a>
	        <script type="text/javascript">
		        function request(paras){ 
		        	var url = location.href;  
		        	var paraString = url.substring(url.indexOf("?")+1,url.length).split("&");  
		        	var paraObj = {}  
		        	for (i=0; j=paraString[i]; i++){  
		        		paraObj[j.substring(0,j.indexOf("=")).toLowerCase()] = j.substring(j.indexOf("=")+1,j.length);  
		        	}  
		        	var returnValue = paraObj[paras.toLowerCase()];  
		        	if(typeof(returnValue)=="undefined"){  
		        		return "";  
		        	}else{  
		        		return returnValue; 
		        	}
	        	}
	        	$(function(){
	        		var selectid = request("selectid");
	 		        var treeid = request("treeid");
	        		$.ajax({
	        			async : false,
	        			url : "showSwfAction.action",
	        			type : 'post',
	        			dataType : 'text',
	        			data:"treeid="+treeid+"&docId="+selectid,
	        			success : function(data) {
	        				if (data == "0") {
	        					openalert("对不起，没有此文件！");
	        				} else {
	        					readFile(data);
	        				}
	        			}
	        		});
	        	});
		        
        		function readFile(url){
        			//var url = 'http://localhost:8088/archive3/dfa7be61-cefd-4b2f-9562-8e9c4a9c0a3b.swf';
    	     		var fp = new FlexPaperViewer(	
    						 'flexpaper/FlexPaperViewer',
    						 'viewerPlaceHolder', { config : {
    						 SwfFile : url,
    						 Scale : 0.6, 
    						 ZoomTransition : 'easeOut',
    						 ZoomTime : 0.5,
    						 ZoomInterval : 0.2,
    						 FitPageOnLoad : true,
    						 FitWidthOnLoad : false,
    						 PrintEnabled : false,
    						 FullScreenAsMaxWindow : false,
    						 ProgressiveLoading : true,
    						 MinZoomSize : 0.2,
    						 MaxZoomSize : 5,
    						 SearchMatchAll : false,
    						 InitViewMode : 'Portrait',
    						 
    						 ViewModeToolsVisible : true,
    						 ZoomToolsVisible : true,
    						 NavToolsVisible : true,
    						 CursorToolsVisible : true,
    						 SearchToolsVisible : true,
      						
      						 localeChain: 'zh_CN'
   						 	}});
            	}
	        </script>
        </div>
  </body>
</html>
